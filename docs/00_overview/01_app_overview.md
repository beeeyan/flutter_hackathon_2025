# アプリ概要書

## 1. アプリ概要

**名称（仮）：** タップでわかる相手の熱量（ミャクアリかどうか）
**コンセプト：** 「熱量（脈）」を「タップ数」で可視化する、合コン終盤専用のモバイルマッチングアプリ。

参加者は「持ち点 100 回」のタップ権を持ち、制限時間内に気になる相手に対して熱量を割り振ります。そのタップ数（＝脈）はリアルタイムで視覚演出として同期され、タイムアップ後に「互いの熱量が高いペア」を成立として発表します。

## 2. 背景

合コンや飲み会の終盤において、「誰が誰を気になっているのか」を探り合う時間は、心理的な駆け引きが楽しくもある反面、以下のような課題があります。

- 直接聞くのは恥ずかしい、または気まずい。
- 誰ともマッチングしなかった場合のダメージを恐れて行動できない。
- 場を盛り上げるための「きっかけ」や「エンタメ」が不足しがち。

## 3. 目的

- **「脈（好意）」の可視化：** タップという身体的なアクションを通じて、言葉にしづらい好意を数値（熱量）として表現する。
- **エンタメ化：** リアルタイムの演出と結果発表をイベント化することで、気まずさを解消し、その後の二次会や連絡先交換へのハードルを下げる。
- **ハッカソンテーマ「みゃく」の体現：** ドキドキする心拍数（脈）を、連打および画面演出と同期させる。

## 4. ターゲット

- **メイン：** 合コン（20 代〜30 代の男女）の参加者。
- **サブ：** 懇親会やパーティで、気になる人と繋がりたい参加者。

## 5. 機能要件

### 5.1 認証・ルーム管理

- **匿名認証:** Firebase Authentication（Anonymous）を使用。
- **ルーム作成（幹事）：** 幹事が部屋を作成し、入室用 QR コードを生成・表示する。
- **ルーム参加（ゲスト）：** 参加者はアプリ内のカメラ等で QR コードを読み取るか、ID を入力して入室する。ニックネームと簡単なアバター設定のみで参加。

### 5.2 メイン機能（タッピング）

- **制限時間カウントダウン:**
  - 幹事の開始合図（またはルーム作成時）でタイマーが作動。
  - 全員の画面で残り時間が同期して表示される。
- **投票アクション:**
  - 制限時間内に、持ち点「100」を上限に気になる相手のボタンを連打する。
  - タイムアップ（0 秒）と同時にタップ不可となる。
- **リアルタイム演出（同期タップ）：**
  - 自分宛てのタップ数が増えると、**送信者のアイコンが大きく（または豪華に）変化**する。
  - ※誰からのタップかはこの時点で判別可能（「バレるドキドキ感」重視）。
- **通信制御（連打対策）：**
  - **オプティミスティック UI:** 自分の画面上のカウントは即時反映。
  - **バッチ送信:** 20 タップごと、または操作停止から一定時間経過後に Firestore へ書き込み。

### 5.3 結果発表

- **自動集計:** タイムリミット到達時に自動で集計処理へ移行する。
- **ペア成立発表:** お互いに一定以上のタップ数を送り合ったペア（脈アリ）を画面に表示する。

## 6. 開発前提条件

### 6.1 技術スタック

- **Frontend:** Flutter
- **Backend:** Firebase (Authentication, Firestore)
- **Target Platform:** iOS / Android
  - ※Web Hosting 版は、工数に余裕がある場合の「Nice to have（できれば対応）」とする。

### 6.2 制約事項

- **開発期間:** 2 日間（ハッカソン）
- **Firestore 制限対策:** クライアント（Flutter）側でのバッファリング処理（Debounce 等）を必須とする。

### 6.3 未確定事項（推測による補完）

以下の点は議論内で明言されていないため、一般的な Flutter 開発の観点から推測して仮置きしています。

- **QR コードの挙動:**
  - Flutter アプリ内に QR スキャナー機能を実装するか、標準カメラで読み取って Deep Link でアプリを起動するか未定。
  - _推測:_ ハッカソンでは実装容易性を優先し、単に「ルーム ID 文字列」を QR 化し、アプリ内のテキストボックスに入力する運用でも可とする。
- **タイマーの同期ロジック:**
  - _推測:_ Firestore のルームドキュメントに `startTime` を持ち、各端末で `endTime` を計算して表示する（サーバー時間を厳密に管理する Cloud Functions は使わず、クライアント計算で許容する）。
