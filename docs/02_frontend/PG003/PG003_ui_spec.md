# 画面仕様書: PG003

## 画面メタ

| カラム名   | 内容           |
| ---------- | -------------- |
| 画面 ID    | PG003          |
| 画面名     | ルーム参加入力 |
| 画面物理名 | join_room_page |

## UI 要素一覧（必須）

| 要素 ID | 要素名              | 種別          | 文言キー/アイコン                                 | 初期状態（表示/活性/選択） | 表示/活性条件              |
| ------- | ------------------- | ------------- | ------------------------------------------------- | -------------------------- | -------------------------- |
| E01     | ヘッダータイトル    | Label         | ルームに参加                                      | 表示                       | -                          |
| E02     | 戻るボタン          | Button/Icon   | < (Back)                                          | 表示                       | -                          |
| E03     | QR スキャナービュー | CameraPreview | -                                                 | 表示（権限許可時）         | カメラ権限がある場合のみ   |
| E04     | スキャン枠ガイド    | Image/Overlay | (四角い枠)                                        | 表示                       | E03 が表示中               |
| E05     | 権限拒否メッセージ  | Label         | カメラ権限がないため<br>QR コードは使用できません | 非表示                     | カメラ権限拒否時           |
| E06     | 手動入力ラベル      | Label         | または ID を入力                                  | 表示                       | -                          |
| E07     | ルーム ID 入力欄    | TextField     | Hint: ルーム ID を入力                            | 表示/活性                  | -                          |
| E08     | 参加ボタン          | Button        | この部屋に入る                                    | 表示/非活性                | E07 に入力がある場合活性化 |

## アクション一覧（必須）

| アクション ID | トリガー（操作） | 対象要素 | 前提/ガード | 実行内容（状態変更/副作用）                                                                                                                       | 遷移先                                |
| ------------- | ---------------- | -------- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------- |
| A01           | 画面初期化       | システム | -           | 1. カメラ使用権限をリクエスト<br>2. 許可なら E03 を表示、拒否なら E05 を表示                                                                      | -                                     |
| A02           | E02 (戻る) 押下  | システム | -           | 1. 画面遷移（戻る）                                                                                                                               | PG002                                 |
| A03           | QR コード検知    | システム | スキャン中  | 1. 読み取った文字列（roomId）を取得<br>2. 自動的に A05（参加処理）を実行                                                                          | (A05 へ委譲)                          |
| A04           | E07 (ID) 入力    | E08      | -           | 1. 入力値を保持<br>2. E08 の活性状態を更新                                                                                                        | -                                     |
| A05           | E08 (参加) 押下  | システム | E08 が活性  | 1. ローディング表示開始<br>2. Firestore `rooms/{roomId}` の存在確認<br>3. 存在すれば `rooms/{roomId}/members` に自分を追加<br>4. 成功後、画面遷移 | PG004<br>(引数: roomId, isHost=false) |
